<HTML>
<HEAD><META name="HTML-Generator" content="Dymola"><TITLE>ModelicaAdditions</TITLE></HEAD>
<BODY><P>
<H2><A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3.html#ModelicaAdditions.MultiBody.Examples.Robots.r3"
>ModelicaAdditions.MultiBody.Examples.Robots.r3</A>.Components</H2>
<B>Library of components for the Manutec r3 robot</B>
<P>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MotorI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.ControlI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructureI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPuls"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPulsI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPuls" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobot"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobotI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobot" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControl"
><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControlI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControl" WIDTH=80  HEIGHT=80 ></A>
<P><P>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.AxisType1</H2>
<B>Axis model of the r3 joints 1,2,3 </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1D.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1">
<H3>Information</H3>
<PRE></PRE>
<p>
The axis model consists of the <b>controller</b>, the <b>motor</b> including current
controller and the <b>gearbox</b> including gear elasticity and bearing friction.
The only difference to the axis model of joints 4,5,6 (= model axisType2) is
that elasticity and damping in the gear boxes are not neglected.
The component <b>States</b> is a dummy inertia, i.e., the inertia is zero,
to define that the absolute angle and the absolute angular velocity of the
driven gear flange are used as <b>states</b>.
</p>

<p>
The input signal of this component is the desired angular acceleration
of the joint (= reference acceleration). From the acceleration, the
reference position and reference velocity are computed via integration.
The reference input is an acceleration, because the reference signals
have to be "smooth" (position has to be differentiable at least 2 times).
Otherwise, the gear elasticity leads to significant oscillations which
are not acceptable.
</p>

<p>
Default values of the parameters are given for the axis of joint 1.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>phi_ref0</TD><TD>0</TD><TD>initial value of reference and joint angle [rad]</TD></TR>
<TR><TD>w_ref0</TD><TD>0</TD><TD>initial value of reference and joint speed [rad/s]</TD></TR>
<TR><TD>k</TD><TD>1.1616</TD><TD>gain of motor</TD></TR>
<TR><TD>w</TD><TD>4590</TD><TD>time constant of motor</TD></TR>
<TR><TD>D</TD><TD>0.6</TD><TD>damping constant of motor</TD></TR>
<TR><TD>J</TD><TD>0.0013</TD><TD>moment of inertia of motor in [kgm^2]</TD></TR>
<TR><TD>i</TD><TD>-105</TD><TD>gear ratio</TD></TR>
<TR><TD>c</TD><TD>43</TD><TD>spring constant</TD></TR>
<TR><TD>cd</TD><TD>0.005</TD><TD>damper constant</TD></TR>
<TR><TD>Rv0</TD><TD>0.4</TD><TD>viscous friction torque at zero velocity in [Nm]</TD></TR>
<TR><TD>Rv1</TD><TD>(0.13/160)</TD><TD>viscous friction coefficient in [Nms/rad]</TD></TR>
<TR><TD>peak</TD><TD>1</TD><TD>peak*Rv0 = maximum static friction torque (peak &gt;= 1)</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model AxisType1 &quot;Axis model of the r3 joints 1,2,3 &quot;
  parameter SIunits.Angle phi_ref0=0
    &quot;initial value of reference and joint angle&quot;;
  parameter SIunits.AngularVelocity w_ref0=0
    &quot;initial value of reference and joint speed&quot;;
  parameter Real k=1.1616 &quot;gain of motor&quot;;
  parameter Real w=4590 &quot;time constant of motor&quot;;
  parameter Real D=0.6 &quot;damping constant of motor&quot;;
  parameter Real J=0.0013 &quot;moment of inertia of motor in [kgm^2]&quot;;
  parameter Real i=-105 &quot;gear ratio&quot;;
  parameter Real c=43 &quot;spring constant&quot;;
  parameter Real cd=0.005 &quot;damper constant&quot;;
  parameter Real Rv0=0.4
    &quot;viscous friction torque at zero velocity in [Nm]&quot;;
  parameter Real Rv1=(0.13/160)
    &quot;viscous friction coefficient in [Nms/rad]&quot;;
  parameter Real peak=1
    &quot;peak*Rv0 = maximum static friction torque (peak &gt;= 1)&quot;;
  SIunits.AngularAcceleration a_ref;
  SIunits.AngularVelocity w_ref;
  SIunits.Angle phi_ref;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> inPort_a_ref;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> flange;
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1"
>GearType1</A> r3Gear1(
    J=J,
    i=i,
    c=c,
    d=cd,
    Rv0=Rv0,
    Rv1=Rv1,
    peak=peak);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor"
>Motor</A> r3Motor(
    k=k,
    wm=w,
    D=D);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control"
>Control</A> r3Control;
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Integrator"
>Modelica.Blocks.Continuous.Integrator</A> integrator1(y(final start={w_ref0})
    );
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Integrator"
>Modelica.Blocks.Continuous.Integrator</A> integrator2(y(final start={phi_ref0
          }));
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> k2(k={i});
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> k1(k={i});
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.Inertia"
>Modelica.Mechanics.Rotational.Inertia</A> states(
    J=0,
    phi(start=phi_ref0, fixed=true),
    w(start=w_ref0, fixed=true));
equation
  connect(k1.outPort, r3Control.phi_ref);
  connect(r3Motor.outPort_w, r3Control.w);
  connect(r3Motor.outPort_phi, r3Control.phi);
  connect(integrator1.outPort, integrator2.inPort);
  connect(r3Control.i_ref, r3Motor.i_ref);
  connect(integrator2.outPort, k1.inPort);
  connect(integrator1.outPort, k2.inPort);
  connect(r3Motor.flange_motor, r3Gear1.flange_a);
  connect(integrator1.inPort, inPort_a_ref);
  connect(k2.outPort, r3Control.w_ref);
  connect(r3Gear1.flange_b, states.flange_a);
  connect(states.flange_b, flange);
  a_ref = inPort_a_ref.signal[1];
  w_ref = integrator1.outPort.signal[1];
  phi_ref = integrator2.outPort.signal[1];
end AxisType1;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.AxisType2</H2>
<B>Axis model of the r3 joints 4,5,6 </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2D.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2">
<H3>Information</H3>
<PRE></PRE>
<p>
The axis model consists of the <b>controller</b>, the <b>motor</b> including current
controller and the <b>gearbox</b> including gear elasticity and bearing friction.
The only difference to the axis model of joints 1,2,3 (= model axisType1) is
elasticity and damping in the gear boxes are neglected.
The component <b>States</b> is a dummy inertia, i.e., the inertia is zero,
to define that the absolute angle and the absolute angular velocity of the
driven gear flange are used as <b>states</b>.
</p>

<p>
The input signal of this component is the desired angular acceleration
of the joint (= reference acceleration). From the acceleration, the
reference position and reference velocity are computed via integration.
The reference input is an acceleration, because the reference signals
have to be "smooth" (position has to be differentiable at least 2 times).
Otherwise, the gear elasticity leads to significant oscillations which
are not acceptable.
</p>

<p>
Default values of the parameters are given for the axis of joint 1.
</p>
<PRE>

</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>phi_ref0</TD><TD>0</TD><TD>initial value of reference and of joint angle [rad]</TD></TR>
<TR><TD>w_ref0</TD><TD>0</TD><TD>initial value of reference and joint speed [rad/s]</TD></TR>
<TR><TD>k</TD><TD>0.2365</TD><TD>gain of motor</TD></TR>
<TR><TD>w</TD><TD>6250</TD><TD>time constant of motor</TD></TR>
<TR><TD>D</TD><TD>0.55</TD><TD>damping constant of motor</TD></TR>
<TR><TD>J</TD><TD>1.6e-4</TD><TD>moment of inertia of motor in [kgm^2]</TD></TR>
<TR><TD>i</TD><TD>-99</TD><TD>gear ratio</TD></TR>
<TR><TD>Rv0</TD><TD>21.8</TD><TD>viscous friction torque at zero velocity in [Nm]</TD></TR>
<TR><TD>Rv1</TD><TD>9.8</TD><TD>viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))</TD></TR>
<TR><TD>peak</TD><TD>(26.7/21.8)</TD><TD>peak*Rv0 = maximum static friction torque (peak &gt;= 1)</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model AxisType2 &quot;Axis model of the r3 joints 4,5,6 &quot;
  parameter SIunits.Angle phi_ref0=0
    &quot;initial value of reference and of joint angle&quot;;
  parameter SIunits.AngularVelocity w_ref0=0
    &quot;initial value of reference and joint speed&quot;;
  parameter Real k=0.2365 &quot;gain of motor&quot;;
  parameter Real w=6250 &quot;time constant of motor&quot;;
  parameter Real D=0.55 &quot;damping constant of motor&quot;;
  parameter Real J=1.6e-4 &quot;moment of inertia of motor in [kgm^2]&quot;;
  parameter Real i=-99 &quot;gear ratio&quot;;
  parameter Real Rv0=21.8
    &quot;viscous friction torque at zero velocity in [Nm]&quot;;
  parameter Real Rv1=9.8
    &quot;viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))&quot;;
  parameter Real peak=(26.7/21.8)
    &quot;peak*Rv0 = maximum static friction torque (peak &gt;= 1)&quot;;
  SIunits.AngularAcceleration a_ref;
  SIunits.AngularVelocity w_ref;
  SIunits.Angle phi_ref;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> inPort_a_ref;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> flange;
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2"
>GearType2</A> r3Gear2(
    J=J,
    i=i,
    Rv0=Rv0,
    Rv1=Rv1,
    peak=peak);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor"
>Motor</A> r3Motor(
    k=k,
    wm=w,
    D=D);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control"
>Control</A> r3Control;
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Integrator"
>Modelica.Blocks.Continuous.Integrator</A> integrator1(y(final start={w_ref0})
    );
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Integrator"
>Modelica.Blocks.Continuous.Integrator</A> integrator2(y(final start={phi_ref0
          }));
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> k2(k={i});
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> k1(k={i});
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.Inertia"
>Modelica.Mechanics.Rotational.Inertia</A> states(
    J=0,
    phi(start=phi_ref0, fixed=true),
    w(start=w_ref0, fixed=true));
equation
  connect(integrator1.outPort, integrator2.inPort);
  connect(r3Control.i_ref, r3Motor.i_ref);
  connect(r3Motor.flange_motor, r3Gear2.flange_a);
  connect(k1.outPort, r3Control.phi_ref);
  connect(integrator2.outPort, k1.inPort);
  connect(integrator1.outPort, k2.inPort);
  connect(r3Motor.outPort_w, r3Control.w);
  connect(r3Motor.outPort_phi, r3Control.phi);
  connect(k2.outPort, r3Control.w_ref);
  connect(integrator1.inPort, inPort_a_ref);
  connect(r3Gear2.flange_b, states.flange_a);
  connect(states.flange_b, flange);
  a_ref = inPort_a_ref.signal[1];
  w_ref = integrator1.outPort.signal[1];
  phi_ref = integrator2.outPort.signal[1];
end AxisType2;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructureI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.MechanicalStructure</H2>
<B>Model of the mechanical part of the r3 robot </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructureD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure">
<H3>Information</H3>
<PRE></PRE>
<p>
This model contains the mechanical components of the r3 robot
(multibody system) including animation information.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>loadSize[3]</TD><TD>{0.125,0.05,0.05}</TD><TD>size of (steel) load box [m]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model MechanicalStructure
  &quot;Model of the mechanical part of the r3 robot &quot;
  package SIunits = Modelica.SIunits ;
  parameter SIunits.Length loadSize[3]={0.125,0.05,0.05}
    &quot;size of (steel) load box&quot;;
  SIunits.Angle q[6] &quot;joint angles&quot;;
  SIunits.AngularVelocity qd[6] &quot;joint speeds&quot;;
  SIunits.AngularAcceleration qdd[6] &quot;joint accelerations&quot;;
  SIunits.Torque tau[6] &quot;joint driving torques&quot;;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis1;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis2;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis3;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis4;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis5;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> axis6;
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.InertialSystem"
>ModelicaAdditions.MultiBody.Parts.InertialSystem</A> inertial;
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r1(n={0,1,0});
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r2(n={1,0,0});
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r3(n={1,0,0});
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r4(n={0,1,0});
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r5(n={1,0,0});
  <A HREF="ModelicaAdditions_MultiBody_Joints.html#ModelicaAdditions.MultiBody.Joints.Revolute"
>ModelicaAdditions.MultiBody.Joints.Revolute</A> r6(n={0,1,0});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.Shape"
>ModelicaAdditions.MultiBody.Parts.Shape</A> b0(
    Shape=&quot;cylinder&quot;,
    r0={0,-0.4,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=0.225,
    Width=0.3,
    Height=0.3,
    Material={0,0,1,1});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.ShapeBody"
>ModelicaAdditions.MultiBody.Parts.ShapeBody</A> b1(
    r={0,0,0},
    I22=1.16,
    Shape=&quot;box&quot;,
    r0={0,-0.175,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=0.25,
    Width=0.15,
    Height=0.2,
    Material={1,0,0,0.5});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.ShapeBody"
>ModelicaAdditions.MultiBody.Parts.ShapeBody</A> b2(
    r={0,0.5,0},
    rCM={0.172,0.205,0},
    m=56.5,
    I11=2.58,
    I22=0.64,
    I33=2.73,
    I21=-0.46,
    Shape=&quot;beam&quot;,
    r0={0.15,0,0},
    LengthDirection={0,1,0},
    WidthDirection={0,0,1},
    Length=0.5,
    Width=0.2,
    Height=0.15,
    Material={1,0.7,0,1});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.ShapeBody"
>ModelicaAdditions.MultiBody.Parts.ShapeBody</A> b3(
    r={0,0,0},
    rCM={0.064,-0.034,0},
    m=26.4,
    I11=0.279,
    I22=0.245,
    I33=0.413,
    I21=-0.070,
    Shape=&quot;box&quot;,
    r0={0,-0.075,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=0.15,
    Width=0.15,
    Height=0.15,
    Material={1,0,0,0.5});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.ShapeBody"
>ModelicaAdditions.MultiBody.Parts.ShapeBody</A> b4(
    r={0,0.73,0},
    rCM={0,0.32,0},
    m=28.7,
    I11=1.67,
    I22=0.081,
    I33=1.67,
    Shape=&quot;cylinder&quot;,
    r0={0,0.075,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=0.73,
    Width=0.1,
    Height=0.1,
    Material={1,0.7,0,1});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.ShapeBody"
>ModelicaAdditions.MultiBody.Parts.ShapeBody</A> b5(
    r={0,0,0},
    rCM={0,0.023,0},
    m=5.2,
    I11=1.25,
    I22=0.81,
    I33=1.53,
    Shape=&quot;box&quot;,
    r0={0,-0.075,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=0.225,
    Width=0.075,
    Height=0.1,
    Material={0,0,1,0.5});
  <A HREF="ModelicaAdditions_MultiBody_Parts.html#ModelicaAdditions.MultiBody.Parts.BoxBody"
>ModelicaAdditions.MultiBody.Parts.BoxBody</A> load(
    r={0,0,0},
    r0={0,0.15,0},
    LengthDirection={0,1,0},
    WidthDirection={1,0,0},
    Length=(loadSize[1]),
    Width=(loadSize[2]),
    Height=(loadSize[3]),
    Material={1,0,0,0.5});
equation
  connect(inertial.frame_b, b0.frame_a);
  connect(r1.frame_a, inertial.frame_b);
  connect(r1.frame_b, b1.frame_a);
  connect(b1.frame_b, r2.frame_a);
  connect(r2.frame_b, b2.frame_a);
  connect(b2.frame_b, r3.frame_a);
  connect(r3.frame_b, b3.frame_a);
  connect(r4.frame_b, b4.frame_a);
  connect(r3.frame_b, r4.frame_a);
  connect(b4.frame_b, r5.frame_a);
  connect(r5.frame_b, b5.frame_a);
  connect(r6.frame_b, load.frame_a);
  connect(r5.frame_b, r6.frame_a);
  connect(r1.axis, axis1);
  connect(r2.axis, axis2);
  connect(r4.axis, axis4);
  connect(r5.axis, axis5);
  connect(r6.axis, axis6);
  connect(r3.axis, axis3);
  q = {r1.q,r2.q,r3.q,r4.q,r5.q,r6.q};
  qd = der(q);
  qdd = der(qd);
  tau = {r1.axis.tau,r2.axis.tau,r3.axis.tau,r4.axis.tau,r5.axis.tau,r6.axis.
    tau};
end MechanicalStructure;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobotI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobot" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobot"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.FullRobot</H2>
<B>Complete model of Manutec r3 robot </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobotD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.FullRobot">
<H3>Information</H3>
<PRE></PRE>
<p>
Complete model of Mantuec r3 robot, including
controller, motor, gearbox, 3D-mechanics model.
The input connectors <b>a_refX</b> are the <b>reference accelerations</b>, i.e., the desired
accelerations, for the 6 joint axes. Via parameter <b>q0</b> the initial
joint angles are defined.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>q0[6]</TD><TD></TD><TD>initial joint angles [rad]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model FullRobot &quot;Complete model of Manutec r3 robot &quot;
  parameter SIunits.Angle q0[6] &quot;initial joint angles&quot;;
  output SIunits.Angle q_ref[6] &quot;reference values of joint angles&quot;;
  output SIunits.AngularVelocity qd_ref[6]
    &quot;reference values of joint speeds&quot;;
  output SIunits.AngularAcceleration qdd_ref[6]
    &quot;reference values of joint accelerations&quot;;
  output SIunits.Angle eq[6] &quot;control errors of joint angles&quot;;
  output SIunits.AngularVelocity eqd[6]
    &quot;control errors of joint speeds&quot;;
  <I></I>
  <I></I>
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MechanicalStructure</A>
     mechanics;
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1</A> axis1
    (phi_ref0=q0[1]);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1</A> axis2
    (
    w=5500,
    i=210,
    c=8,
    cd=0.01,
    Rv0=0.5,
    Rv1=(0.1/130),
    phi_ref0=q0[2]);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType1</A> axis3
    (
    w=5500,
    i=60,
    c=58,
    cd=0.04,
    Rv0=0.7,
    Rv1=(0.2/130),
    phi_ref0=q0[3]);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2</A> axis4
    (phi_ref0=q0[4]);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2</A> axis5
    (
    k=0.2608,
    J=1.8e-4,
    i=79.2,
    Rv0=30.1,
    Rv1=0.03,
    peak=(39.6/30.1),
    phi_ref0=q0[5]);
  <A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.AxisType2</A> axis6
    (
    k=0.0842,
    w=7400,
    D=0.27,
    J=4.3e-5,
    i=-99,
    Rv0=10.9,
    Rv1=3.92,
    peak=(16.8/10.9),
    phi_ref0=q0[6]);
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref1;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref2;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref3;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref4;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref5;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> a_ref6;
equation
  connect(axis1.flange, mechanics.axis1);
  connect(axis2.flange, mechanics.axis2);
  connect(axis3.flange, mechanics.axis3);
  connect(axis4.flange, mechanics.axis4);
  connect(axis5.flange, mechanics.axis5);
  connect(axis6.flange, mechanics.axis6);
  connect(axis1.inPort_a_ref, a_ref1);
  connect(axis6.inPort_a_ref, a_ref6);
  connect(axis5.inPort_a_ref, a_ref5);
  connect(axis4.inPort_a_ref, a_ref4);
  connect(axis3.inPort_a_ref, a_ref3);
  connect(axis2.inPort_a_ref, a_ref2);
  q_ref = {axis1.phi_ref,axis2.phi_ref,axis3.phi_ref,axis4.phi_ref,axis5.
    phi_ref,axis6.phi_ref};
  qd_ref = {axis1.w_ref,axis2.w_ref,axis3.w_ref,axis4.w_ref,axis5.w_ref,axis6.
    w_ref};
  qdd_ref = {a_ref1.signal[1],a_ref2.signal[1],a_ref3.signal[1],a_ref4.signal[
    1],a_ref5.signal[1],a_ref6.signal[1]};
  eq = q_ref - mechanics.q;
  eqd = qd_ref - mechanics.qd;
end FullRobot;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.GearType1</H2>
<B>Motor inertia and gearbox model for r3 joints 1,2,3 </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1D.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType1">
<H3>Information</H3>
<PRE>
Models the gearbox used in the first three joints with all its effects,
like elasticity and friction.

Coulomb friction is approximated by a friction element acting
at the &quot;motor&quot;-side. In reality, bearing friction should be
also incorporated at the driven side of the gearbox. However,
this would require considerable more effort for the measurement
of the friction parameters.

Default values for all parameters are given for joint 1.

Model relativeStates is used to define the relative angle
and relative angular velocity across the spring (=gear elasticity)
as state variables. The reason is, that a default initial
value of zero of these states makes always sense.
If the absolute angle and the absolute angular velocity of model
Jmotor would be used as states, and the load angle (= joint angle of
robot) is NOT zero, one has always to ensure that the initial values
of the motor angle and of the joint angle are modified correspondingly.
Otherwise, the spring has an unrealistic deflection at initial time.
Since relative quantities are used as state variables, this simplifies
the definition of initial values considerably.

</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>J</TD><TD>0.0013</TD><TD>moment of inertia of motor [kg.m2]</TD></TR>
<TR><TD>i</TD><TD>-105</TD><TD>gear ratio</TD></TR>
<TR><TD>c</TD><TD>43</TD><TD>spring constant</TD></TR>
<TR><TD>d</TD><TD>0.005</TD><TD>damper constant</TD></TR>
<TR><TD>Rv0</TD><TD>0.4</TD><TD>viscous friction torque at zero velocity [N.m]</TD></TR>
<TR><TD>Rv1</TD><TD>(0.13/160)</TD><TD>viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))</TD></TR>
<TR><TD>peak</TD><TD>1</TD><TD>peak*Rv0 = maximum static friction torque (peak &gt;= 1)</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model GearType1
  &quot;Motor inertia and gearbox model for r3 joints 1,2,3 &quot;
  extends <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.TwoFlanges"
>Modelica.Mechanics.Rotational.Interfaces.TwoFlanges</A>;
  parameter SIunits.Inertia J=0.0013 &quot;moment of inertia of motor&quot;;
  parameter Real i=-105 &quot;gear ratio&quot;;
  parameter Real c=43 &quot;spring constant&quot;;
  parameter Real d=0.005 &quot;damper constant&quot;;
  parameter SIunits.Torque Rv0=0.4
    &quot;viscous friction torque at zero velocity&quot;;
  parameter Real Rv1=(0.13/160)
    &quot;viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))&quot;;
  parameter Real peak=1
    &quot;peak*Rv0 = maximum static friction torque (peak &gt;= 1)&quot;;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.Inertia"
>Modelica.Mechanics.Rotational.Inertia</A> Jmotor(J=J);
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.IdealGear"
>Modelica.Mechanics.Rotational.IdealGear</A> gear(ratio=i);
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.SpringDamper"
>Modelica.Mechanics.Rotational.SpringDamper</A> spring(c=c, d=d);
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.RelativeStates"
>Modelica.Mechanics.Rotational.RelativeStates</A> relativeStates;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.BearingFriction"
>Modelica.Mechanics.Rotational.BearingFriction</A> bearingFriction(tau_pos=[0
        , Rv0; 1, Rv0 + Rv1]);
equation
  connect(spring.flange_b, gear.flange_a);
  connect(relativeStates.flange_b, spring.flange_b);
  connect(relativeStates.flange_a, spring.flange_a);
  connect(bearingFriction.flange_b, spring.flange_a);
  connect(Jmotor.flange_b, bearingFriction.flange_a);
  connect(Jmotor.flange_a, flange_a);
  connect(gear.flange_b, flange_b);
end GearType1;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2I.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.GearType2</H2>
<B>Motor inertia and gearbox model for r3 joints 4,5,6  </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2D.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.GearType2">
<H3>Information</H3>
<PRE>The elasticity and damping in the gearboxes of the outermost
three joints of the robot is neglected.

Default values for all parameters are given for joint 4.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>J</TD><TD>1.6e-4</TD><TD>moment of inertia of motor [kg.m2]</TD></TR>
<TR><TD>i</TD><TD>-99</TD><TD>gear ratio</TD></TR>
<TR><TD>Rv0</TD><TD>21.8</TD><TD>viscous friction torque at zero velocity [N.m]</TD></TR>
<TR><TD>Rv1</TD><TD>9.8</TD><TD>viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))</TD></TR>
<TR><TD>peak</TD><TD>(26.7/21.8)</TD><TD>peak*Rv0 = maximum static friction torque (peak &gt;= 1)</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model GearType2
  &quot;Motor inertia and gearbox model for r3 joints 4,5,6  &quot;
  extends <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.TwoFlanges"
>Modelica.Mechanics.Rotational.Interfaces.TwoFlanges</A>;
  parameter SIunits.Inertia J=1.6e-4 &quot;moment of inertia of motor&quot;;
  parameter Real i=-99 &quot;gear ratio&quot;;
  parameter SIunits.Torque Rv0=21.8
    &quot;viscous friction torque at zero velocity&quot;;
  parameter Real Rv1=9.8
    &quot;viscous friction coefficient in [Nms/rad] (R=Rv0+Rv1*abs(qd))&quot;;
  parameter Real peak=(26.7/21.8)
    &quot;peak*Rv0 = maximum static friction torque (peak &gt;= 1)&quot;;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.Inertia"
>Modelica.Mechanics.Rotational.Inertia</A> Jmotor(J=J);
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.IdealGear"
>Modelica.Mechanics.Rotational.IdealGear</A> gear(ratio=i);
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.BearingFriction"
>Modelica.Mechanics.Rotational.BearingFriction</A> bearingFriction(tau_pos=[0
        , Rv0; 1, Rv0 + Rv1], peak=peak);
equation
  connect(Jmotor.flange_a, flange_a);
  connect(gear.flange_b, bearingFriction.flange_a);
  connect(bearingFriction.flange_b, flange_b);
  connect(Jmotor.flange_b, gear.flange_a);
end GearType2;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MotorI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.Motor</H2>
<B>Motor model including current controller of r3 motors </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.MotorD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Motor">
<H3>Information</H3>
<PRE> Default values are given for the motor of joint 1.
The input of the motor is the desired current
(the actual current is proportional to the torque
produced by the motor).
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>k</TD><TD>1.1616</TD><TD>gain of motor</TD></TR>
<TR><TD>wm</TD><TD>4590</TD><TD>time constant of motor</TD></TR>
<TR><TD>D</TD><TD>0.6</TD><TD>damping constant of motor</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Motor &quot;Motor model including current controller of r3 motors &quot;
  extends <A HREF="../../modelica/help/Modelica_Icons.html#Modelica.Icons.MotorIcon"
>Modelica.Icons.MotorIcon</A>;
  parameter Real k=1.1616 &quot;gain of motor&quot;;
  parameter Real wm=4590 &quot;time constant of motor&quot;;
  parameter Real D=0.6 &quot;damping constant of motor&quot;;
  <I></I>
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> i_ref;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> flange_motor;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.OutPort"
>Modelica.Blocks.Interfaces.OutPort</A> outPort_w;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.OutPort"
>Modelica.Blocks.Interfaces.OutPort</A> outPort_phi;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SignalVoltage"
>Modelica.Electrical.Analog.Sources.SignalVoltage</A> Vs;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Ideal.html#Modelica.Electrical.Analog.Ideal.IdealOpAmp"
>Modelica.Electrical.Analog.Ideal.IdealOpAmp</A> diff;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Ideal.html#Modelica.Electrical.Analog.Ideal.IdealOpAmp"
>Modelica.Electrical.Analog.Ideal.IdealOpAmp</A> power;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.EMF"
>Modelica.Electrical.Analog.Basic.EMF</A> emf(k=k);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</A> La(L=(250/(2*D*wm)));
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Ra(R=250);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rd2(R=100);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Capacitor"
>Modelica.Electrical.Analog.Basic.Capacitor</A> C(C=0.004*D/wm);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Ideal.html#Modelica.Electrical.Analog.Ideal.IdealOpAmp"
>Modelica.Electrical.Analog.Ideal.IdealOpAmp</A> OpI;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rd1(R=100);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Ri(R=10);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rp1(R=200);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rp2(R=50);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rd4(R=100);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SignalVoltage"
>Modelica.Electrical.Analog.Sources.SignalVoltage</A> hall2;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</A> Rd3(R=100);
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</A> g1;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</A> g2;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</A> g3;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Sensors.html#Modelica.Electrical.Analog.Sensors.CurrentSensor"
>Modelica.Electrical.Analog.Sensors.CurrentSensor</A> hall1;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</A> g4;
  <A HREF="../../modelica/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</A> g5;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Sensors.html#Modelica.Mechanics.Rotational.Sensors.AngleSensor"
>Modelica.Mechanics.Rotational.Sensors.AngleSensor</A> phi;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Sensors.html#Modelica.Mechanics.Rotational.Sensors.SpeedSensor"
>Modelica.Mechanics.Rotational.Sensors.SpeedSensor</A> w;
equation
  connect(La.n, emf.p);
  connect(Ra.n, La.p);
  connect(Rd2.n, diff.n1);
  connect(C.n, OpI.p2);
  connect(OpI.p2, power.p1);
  connect(Vs.p, Rd2.p);
  connect(diff.n1, Rd1.p);
  connect(Rd1.n, diff.p2);
  connect(diff.p2, Ri.p);
  connect(Ri.n, OpI.n1);
  connect(OpI.n1, C.p);
  connect(power.n1, Rp1.p);
  connect(power.p2, Rp1.n);
  connect(Rp1.p, Rp2.p);
  connect(power.p2, Ra.p);
  connect(Rd3.p, hall2.p);
  connect(Rd3.n, diff.p1);
  connect(Rd3.n, Rd4.p);
  connect(Vs.n, g1.p);
  connect(g2.p, hall2.n);
  connect(Rd4.n, g3.p);
  connect(g3.p, OpI.p1);
  connect(hall1.outPort, hall2.inPort);
  connect(g5.p, Rp2.n);
  connect(emf.n, hall1.p);
  connect(hall1.n, g4.p);
  connect(emf.flange_b, phi.flange_a);
  connect(emf.flange_b, w.flange_a);
  connect(w.outPort, outPort_w);
  connect(phi.outPort, outPort_phi);
  connect(flange_motor, emf.flange_b);
  connect(OpI.n2, power.n2);
  connect(OpI.p1, OpI.n2);
  connect(OpI.p1, diff.n2);
  connect(Vs.inPort, i_ref);
end Motor;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.ControlI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.Control</H2>
<B>Controller model of r3 robot </B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.ControlD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.Control">
<H3>Information</H3>
<PRE></PRE>
<p>
For the robot 6 identical controllers are used.
Therefore, this class has no parameters.
</p>

<p>
In reality, the position controller is realized in digital
form (components Kv, Kd). For efficiency reasons, this
controller part is modelled as continuous component.
By simulation it has been shown, that the difference in the
results is below the plot accuracy.
</p>
<PRE>
</PRE>
<H3>Modelica definition</H3>
<PRE>
model Control &quot;Controller model of r3 robot &quot;
  extends <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> phi_ref;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> w_ref;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> phi;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> w;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.OutPort"
>Modelica.Blocks.Interfaces.OutPort</A> i_ref;
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.TransferFunction"
>Modelica.Blocks.Continuous.TransferFunction</A> rate2(b={9.95e-3,1}, a={
        0.56e-3,1});
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Integrator"
>Modelica.Blocks.Continuous.Integrator</A> rate3(k={340.8});
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.TransferFunction"
>Modelica.Blocks.Continuous.TransferFunction</A> rate1(b={40e-3,1}, a={20.2e-3
        ,1});
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.FirstOrder"
>Modelica.Blocks.Continuous.FirstOrder</A> tacho1(k={0.03}, T={8.475e-4});
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> Kd(k={0.03});
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</A> wSum;
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</A> sum;
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</A> pSum;
  <A HREF="../../modelica/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</A> Kv(k={0.3});
  <A HREF="../../modelica/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.TransferFunction"
>Modelica.Blocks.Continuous.TransferFunction</A> tacho2(a={1/(2014*2014),2*
        0.294/2014,1});
equation
  connect(rate2.outPort, rate3.inPort);
  connect(wSum.outPort, rate2.inPort);
  connect(sum.outPort, wSum.inPort1);
  connect(Kd.outPort, sum.inPort1);
  connect(rate3.outPort, i_ref);
  connect(rate1.outPort, wSum.inPort2);
  connect(Kv.inPort, pSum.outPort);
  connect(tacho1.outPort, tacho2.inPort);
  connect(tacho2.outPort, rate1.inPort);
  connect(Kv.outPort, sum.inPort2);
  connect(Kd.inPort, w_ref);
  connect(pSum.inPort1, phi_ref);
  connect(pSum.inPort2, phi);
  connect(tacho1.inPort, w);
end Control;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPulsI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPuls" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPuls"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.TwoPuls</H2>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPulsD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.TwoPuls">
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>T1</TD><TD>1</TD><TD></TD></TR>
<TR><TD>T2</TD><TD>1</TD><TD></TD></TR>
<TR><TD>Height</TD><TD>1</TD><TD></TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model TwoPuls
  extends <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.SO"
>Modelica.Blocks.Interfaces.SO</A>;
  parameter Real T1=1;
  parameter Real T2=1;
  parameter Real Height=1;
equation
  y = if time &lt; T1 then Height else if time &lt; T1 + T2 then 0.0 else if
    time &lt; T1 + T2 + T1 then -Height else 0;
end TwoPuls;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControlI.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControl" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControl"></A><A HREF="ModelicaAdditions_MultiBody_Examples_Robots_r3_Components.html#ModelicaAdditions.MultiBody.Examples.Robots.r3.Components"
>ModelicaAdditions.MultiBody.Examples.Robots.r3.Components</A>.SimpleControl</H2>
<B>Simple PD-controller to control one axis</B><p>
<IMG SRC="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControlD.gif" ALT="ModelicaAdditions.MultiBody.Examples.Robots.r3.Components.SimpleControl">
<H3>Information</H3>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>k</TD><TD>0</TD><TD>gain of P-controller</TD></TR>
<TR><TD>d</TD><TD>0</TD><TD>gain of D-controller (= velocity dependent damping in the joint)</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model SimpleControl &quot;Simple PD-controller to control one axis&quot;
  package SIunits = Modelica.SIunits ;
  parameter Real k=0 &quot;gain of P-controller&quot;;
  parameter Real d=0
    &quot;gain of D-controller (= velocity dependent damping in the joint)&quot;
    ;
  output SIunits.Angle q_ref &quot;reference angle&quot;;
  output SIunits.Angle q &quot;actual joint angle&quot;;
  output SIunits.AngularVelocity qd &quot;actual joint speed&quot;;
  <A HREF="../../modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> inPort_q_ref;
  <A HREF="../../modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> flange;
equation
  q_ref = inPort_q_ref.signal[1];
  q = flange.phi;
  qd = der(q);
  flange.tau = k*(q - q_ref) + d*qd;
end SimpleControl;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Tue Jun 20 22:23:23 2000
.
</address></BODY>
</HTML>
