<HTML>
<HEAD><META name="HTML-Generator" content="Dymola"><TITLE>ModelicaAdditions</TITLE></HEAD>
<BODY><P>
<H2><A NAME="ModelicaAdditions.Blocks.Discrete"></A><A HREF="ModelicaAdditions_Blocks.html#ModelicaAdditions.Blocks"
>ModelicaAdditions.Blocks</A>.Discrete</H2>
<B>Discrete input/output blocks with fixed sample period</B>
<P>
<A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.InterfacesI.gif" ALT="ModelicaAdditions.Blocks.Discrete.Interfaces" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.Sampler"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.SamplerI.gif" ALT="ModelicaAdditions.Blocks.Discrete.Sampler" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.ZeroOrderHold"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.ZeroOrderHoldI.gif" ALT="ModelicaAdditions.Blocks.Discrete.ZeroOrderHold" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.FirstOrderHold"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.FirstOrderHoldI.gif" ALT="ModelicaAdditions.Blocks.Discrete.FirstOrderHold" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.UnitDelay"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.UnitDelayI.gif" ALT="ModelicaAdditions.Blocks.Discrete.UnitDelay" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.TransferFunction"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.TransferFunctionI.gif" ALT="ModelicaAdditions.Blocks.Discrete.TransferFunction" WIDTH=80  HEIGHT=80 ></A>
<A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete.StateSpace"
><IMG SRC="ModelicaAdditions.Blocks.Discrete.StateSpaceI.gif" ALT="ModelicaAdditions.Blocks.Discrete.StateSpace" WIDTH=80  HEIGHT=80 ></A>
<P><P>
<H3>Information</H3>
<PRE>
</PRE>
<p>
This package contains <b>discrete control blocks</b>
with <b>fixed sample period</b>.
Every component of this package is structured in the following way:
</p>

<ol>
<li> A component has <b>continuous real</b> input and output signals.</li>
<li> The <b>input</b> signals are <b>sampled</b> by the given sample period
     defined via parameter <b>samplePeriod</b>.
     The first sample instant is defined by parameter <b>startTime</b>.
<li> The <b>output</b> signals are computed from the sampled input signals.
</ol>

<p>
A <b>sampled data system</b> may consist of components of package <b>Discrete</b>
and of every other purely <b>algebraic</b> input/output block, such
as the components of packages <b>Modelica.Blocks.Math</b>,
<b>Modelica.Blocks.Nonlinear</b> or <b>Modelica.Blocks.Sources</b>.
</p>

<p>
This package contains the following components:
</p>

<pre>
   <b>Integrator</b>        Discrete-time approximation of integrator
   <b>LimIntegrator</b>     Discrete-time approximation of integrator
                     with limited values of the outputs
   <b>Derivative</b>        Discrete-time approximation of derivative block
   <b>FirstOrder</b>        Discrete-time approximation of first order system
   <b>SecondOrder</b>       Discrete-time approximation of second order system
   <b>PI</b>                Discrete-time approximation of PI controller
   <b>PID</b>               Discrete-time approximation of PID controller
   <b>LimPID</b>            Discrete-time PID controller with limited output,
                     anti-windup compensation and set-point weighting
   <b>TransferFunction</b>  Discrete-time approximation of transfer function
   <b>StateSpace</b>        Discrete-time approximation of state space system
   <b>ADconverter</b>       Analog to digital converter
   <b>DAconverter</b>       Digital to analog converter
   <b>Sampler</b>           Ideal sampling of continuous signals
   <b>ZeroOrderHold</b>     Zero order hold of a sampled-data system
   <b>UnitDelay</b>         Delay input signal by one sampling period
</pre>

<p>
This package is not part of the Modelica standard library, because it is
planned to realize an improved package with vectorized components (similiar
to the Modelica.Blocks.Continuous package) and
several different ways to define the sample period. Especially,
the sample period may optionally be defined via an outer parameter in a
higher level.
This features cannot be provided in a satisfactory way in Modelica version 1.3,
due to some missing properties of the replaceable attribute.
</p>

<dl>
<dt><b>Main Author:</b>
<dd><a href="http://www.op.dlr.de/~otter/">Martin Otter</a><br>
    Deutsches Zentrum f&uuml;r Luft und Raumfahrt e.V. (DLR)<br>
    Institut f&uuml;r Robotik und Mechatronik<br>
    Postfach 1116<br>
    D-82230 Wessling<br>
    Germany<br>
    email: <A HREF="mailto:Martin.Otter@dlr.de">Martin.Otter@dlr.de</A><br>
</dl>
<br>

<p><b>Release Notes:</b></p>
<ul>
<li><i>June 18, 2000</i>
       by <a href="http://www.op.dlr.de/~otter/">Martin Otter</a>:<br>
       Realized based on a corresponding library of Dieter Moormann and
       Hilding Elmqvist</li>
</ul>
<br>

<p><b>Copyright (C) 2000, DLR.</b></p>

<p><i>
The Discrete package is <b>free</b> software;
it can be redistributed and/or modified
under the terms of the <b>Modelica license</b>, see the license conditions
and the accompanying <b>disclaimer</b> in the documentation of package
Modelica in file "Modelica/package.mo".
</i></p>
<PRE>
</PRE><P>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.SamplerI.gif" ALT="ModelicaAdditions.Blocks.Discrete.Sampler" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.Sampler"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.Sampler</H2>
<B>Ideal sampling of continuous signals</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.SamplerD.gif" ALT="ModelicaAdditions.Blocks.Discrete.Sampler">
<H3>Information</H3>
<PRE></PRE>
<p>
Samples the continues input signals with a sampling rate defined
via parameter <b>samplePeriod</b>.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<I><TR><TD>n</TD><TD>1</TD><TD>Number of inputs (= number of outputs)</TD></TR>
</I><I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
block Sampler &quot;Ideal sampling of continuous signals&quot;
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteMIMOs"
>Interfaces.DiscreteMIMOs</A>;
  <I></I>
equation
  when sampleTrigger then
    y = u;
  end when;
end Sampler;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.ZeroOrderHoldI.gif" ALT="ModelicaAdditions.Blocks.Discrete.ZeroOrderHold" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.ZeroOrderHold"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.ZeroOrderHold</H2>
<B>Zero order hold of a sampled-data system</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.ZeroOrderHoldD.gif" ALT="ModelicaAdditions.Blocks.Discrete.ZeroOrderHold">
<H3>Information</H3>
<PRE></PRE>
<p>
The output is identical to the sampled input signal at sample
time instants and holds the output at the value of the last
sample instant during the sample points.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<I><TR><TD>n</TD><TD>1</TD><TD>Number of inputs (= number of outputs)</TD></TR>
</I><I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
block ZeroOrderHold &quot;Zero order hold of a sampled-data system&quot;
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteMIMOs"
>Interfaces.DiscreteMIMOs</A>;
protected
  discrete Real ySample[n];
equation
  when sampleTrigger then
    ySample = u;
  end when;
  <I>/* Define y=ySample with an infinitesimal delay to break potential
       algebraic loops if both the continuous and the discrete part have
       direct feedthrough
    */</I>
  y = pre(ySample);
end ZeroOrderHold;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.FirstOrderHoldI.gif" ALT="ModelicaAdditions.Blocks.Discrete.FirstOrderHold" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.FirstOrderHold"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.FirstOrderHold</H2>
<B>First order hold of a sampled-data system</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.FirstOrderHoldD.gif" ALT="ModelicaAdditions.Blocks.Discrete.FirstOrderHold">
<H3>Information</H3>
<PRE></PRE>
<p>
The output signal is the extrapolation through the
values of the last two sampled input signals.
</p>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<I><TR><TD>n</TD><TD>1</TD><TD>Number of inputs (= number of outputs)</TD></TR>
</I><I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
block FirstOrderHold &quot;First order hold of a sampled-data system&quot;
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteMIMOs"
>Interfaces.DiscreteMIMOs</A>;
protected
  discrete Real ySample[n];
  discrete Real tSample;
  discrete Real c[n];
equation
  when sampleTrigger then
    ySample = u;
    tSample = time;
    c = if firstTrigger then zeros(n) else (ySample - pre(ySample))/
      samplePeriod;
  end when;
  <I>/* Use pre(ySample) and pre(c) to break potential algebraic loops by an
       infinitesimal delay if both the continuous and the discrete part
       have direct feedthrough.
    */</I>
  y = pre(ySample) + pre(c)*(time - tSample);
end FirstOrderHold;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.UnitDelayI.gif" ALT="ModelicaAdditions.Blocks.Discrete.UnitDelay" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.UnitDelay"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.UnitDelay</H2>
<B>Unit Delay Block</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.UnitDelayD.gif" ALT="ModelicaAdditions.Blocks.Discrete.UnitDelay">
<H3>Information</H3>
<PRE>
</PRE>
<p>
This block describes a unit delay:
</p>

<pre>
          1
     y = --- * u
          z
</pre>

<p>
that is, the output signal y is the input signal u of the
previous sample instant. Before the second sample instant,
the output y is identical to parameter yStart.
</p>

<p><b>Release Notes:</b></p>
<ul>
<li><i>June 13, 2000</i>
       by <a href="http://www.op.dlr.de/~otter/">Martin Otter</a>:<br>
       Realized, based on a model of Dieter Moormann.
</li>
</ul>

<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>yStart[:]</TD><TD>{0}</TD><TD>Initial values of output signals</TD></TR>
<I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
block UnitDelay &quot;Unit Delay Block&quot;
  parameter Real yStart[:]={0} &quot;Initial values of output signals&quot;;
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteMIMOs"
>Interfaces.DiscreteMIMOs</A>(
    final n=size(yStart, 1),
    y(final start=yStart),
    outPort(signal(start=yStart)));
  <I></I>
protected
  discrete Real yTemp[n](start=yStart);
equation
  when sampleTrigger then
    yTemp = u;
    y = pre(yTemp);
  end when;
end UnitDelay;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.TransferFunctionI.gif" ALT="ModelicaAdditions.Blocks.Discrete.TransferFunction" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.TransferFunction"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.TransferFunction</H2>
<B>Discrete Transfer Function block</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.TransferFunctionD.gif" ALT="ModelicaAdditions.Blocks.Discrete.TransferFunction">
<H3>Information</H3>
<PRE>
</PRE>
<p>
The <b>discrete transfer function</b> block defines the transfer
function between the input signal u and the output
signal y. The numerator has the order nb-1, the
denominator has the order na-1.
</p>

<pre>
          b(1)*z^(nb-1) + b(2)*z^(nb-2) + ... + b(nb)
   y(z) = -------------------------------------------- * u(z)
          a(1)*z^(na-1) + a(2)*z^(na-2) + ... + a(na)
</p>

p>
State variables <b>x</b> are defined according to <b>controller canonical</b>
form. Initial values of the states can be set as start values of <b>x</b>.
<p>

<p>
Example:
</p>

<pre>
     Blocks.Discrete.TransferFunction g(b = {2,4}, a = {1,3});
</pre>

<p>
results in the following transfer function:
</p>

<pre>
        2*z + 4
   y = --------- * u
         z + 3
</pre>

<p><b>Release Notes:</b></p>
<ul>
<li><i>June 18, 2000</i>
       by <a href="http://www.op.dlr.de/~otter/">Martin Otter</a>:<br>
       Realized based on a corresponding model of Dieter Moormann
       and Hilding Elmqvist.
</li>
</ul>
<PRE></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>b[:]</TD><TD>{1}</TD><TD>Numerator coefficients of transfer function.</TD></TR>
<TR><TD>a[:]</TD><TD>{1,1}</TD><TD>Denominator coefficients of transfer function.</TD></TR>
<I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
block TransferFunction &quot;Discrete Transfer Function block&quot;
  parameter Real b[:]={1}
    &quot;Numerator coefficients of transfer function.&quot;;
  parameter Real a[:]={1,1}
    &quot;Denominator coefficients of transfer function.&quot;;
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteSISO"
>Interfaces.DiscreteSISO</A>;
  output Real x[size(a, 1) - 1]
    &quot;State of transfer function from controller canonical form&quot;;
protected
  parameter Integer nb=size(b, 1)
    &quot;Size of Numerator of transfer function&quot;;
  parameter Integer na=size(a, 1)
    &quot;Size of Denominator of transfer function&quot;;
  Real x1;
  Real xn;
equation
  when sampleTrigger then
    <I>/* State variables x are defined according to
       controller canonical form. */</I>
    [x; xn] = [x1; pre(x)];
    [u] = transpose([a])*[x1; pre(x)];
    [y] = transpose([zeros(na - nb, 1); b])*[x1; pre(x)];
  end when;
end TransferFunction;
</PRE>
<HR>
<H2><IMG SRC="ModelicaAdditions.Blocks.Discrete.StateSpaceI.gif" ALT="ModelicaAdditions.Blocks.Discrete.StateSpace" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ModelicaAdditions.Blocks.Discrete.StateSpace"></A><A HREF="ModelicaAdditions_Blocks_Discrete.html#ModelicaAdditions.Blocks.Discrete"
>ModelicaAdditions.Blocks.Discrete</A>.StateSpace</H2>
<B>Discrete State Space block</B><p>
<IMG SRC="ModelicaAdditions.Blocks.Discrete.StateSpaceD.gif" ALT="ModelicaAdditions.Blocks.Discrete.StateSpace">
<H3>Information</H3>
<PRE>
</PRE>
<p>
The <b>discrete state space</b> block defines the relation
between the input u=inPort.signal and the output
y=outPort.signal in state space form:
</p>

<pre>
    x = A * pre(x) + B * u
    y = C * pre(x) + D * u
</pre>

<p>
where pre(x) is the value of the discrete state x at
the previous sample time instant.
The input is a vector of length nu, the output is a vector
of length ny and nx is the number of states. Accordingly
</p>
<pre>
        A has the dimension: A(nx,nx),
        B has the dimension: B(nx,nu),
        C has the dimension: C(ny,nx),
        D has the dimension: D(ny,nu)
</pre>

<p>
Example:
</p>
<pre>
     parameter: A = [0.12, 2;3, 1.5]
     parameter: B = [2, 7;3, 1]
     parameter: C = [0.1, 2]
     parameter: D = zeros(ny,nu)
results in the following equations:

  [x[1]]   [0.12  2.00] [pre(x[1])]   [2.0  7.0] [u[1]]
  [    ] = [          ]*[         ] + [        ]*[    ]
  [x[2]]   [3.00  1.50] [pre(x[2])]   [0.1  2.0] [u[2]]

                             [pre(x[1])]            [u[1]]
       y[1]   = [0.1  2.0] * [         ] + [0  0] * [    ]
                             [pre(x[2])]            [u[2]]
</pre>
<PRE>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>A[:, size(A, 1)]</TD><TD>[1, 0; 0, 1]</TD><TD>Matrix A of state space model</TD></TR>
<TR><TD>B[size(A, 1), :]</TD><TD>[1; 1]</TD><TD>Matrix B of state space model</TD></TR>
<TR><TD>C[:, size(A, 1)]</TD><TD>[1, 1]</TD><TD>Matrix C of state space model</TD></TR>
<TR><TD>D[size(C, 1), size(B, 2)]</TD><TD>zeros(size(C, 1), size(B, 2))</TD><TD>Matrix D of state space model</TD></TR>
<I><TR><TD>samplePeriod</TD><TD>0.1</TD><TD>Sample period of component [s]</TD></TR>
</I><I><TR><TD>startTime</TD><TD>0</TD><TD>First sample time instant [s]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
model StateSpace &quot;Discrete State Space block&quot;
  parameter Real A[:, size(A, 1)]=[1, 0; 0, 1]
    &quot;Matrix A of state space model&quot;;
  parameter Real B[size(A, 1), :]=[1; 1]
    &quot;Matrix B of state space model&quot;;
  parameter Real C[:, size(A, 1)]=[1, 1]
    &quot;Matrix C of state space model&quot;;
  parameter Real D[size(C, 1), size(B, 2)]=zeros(size(C, 1), size(B, 2))
    &quot;Matrix D of state space model&quot;;
  <I></I>
  extends <A HREF="ModelicaAdditions_Blocks_Discrete_Interfaces.html#ModelicaAdditions.Blocks.Discrete.Interfaces.DiscreteMIMO"
>Interfaces.DiscreteMIMO</A>(final nin=size(B, 2), final nout=size(C, 1));
  output Real x[size(A, 1)] &quot;State vector&quot;;
  <I></I>
equation
  when sampleTrigger then
    x = A*pre(x) + B*u;
    y = C*pre(x) + D*u;
  end when;
end StateSpace;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Tue Jun 20 22:12:50 2000
.
</address></BODY>
</HTML>
